---
title: "MapsTest"
author: "Zach and Natalie"
date: "5/9/2019"
DisplayMode: Showcase
Type: Shiny
Output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = FALSE}
library(tidyverse)
library(rvest)
library(httr)
library(shiny)
library(ggplot2)
library(maps)
library(readr)
library(AER)
library(dplyr)
```

```{r}
AidWorldTib <- read.csv("~/Mscs 264 S19/Inclass/AidWorldTib.csv")%>%
  select(-X,-`GDP.US.million.`, -`Corporate.tax`, -AnnualMinWage)%>%
  mutate(TotalLiteracy = (sum(YouthLitRate, AdultLitRate, ElderlyLitRate, na.rm =TRUE)/3),
         OverAverageLit = ifelse(TotalLiteracy>= 91, "Yes", "No"),
         OverAverageLife = ifelse(`Both.sexes.lifeexpectancy..HALE.`>=71.5, "Yes", "No"),
         OverAveragePoverty = ifelse(PercentPoverty>=35, "Yes", "No"),
         EconAidPerCapita = (EconAssist*1000000/Population),
         MilAidPerCapita = (MilitaryAssist*1000000/Population))%>%
  rename("TotalExpectancy" = `Both.sexes.lifeexpectancy..HALE.`,
         "FemaleExpectancy"= `Female.life.expectancy`,
         "MaleExpectancy" = `Male.life.expectancy`)%>%
  view
world <- map_data("world")%>% 
  rename(place = region)%>%
  mutate(place = ifelse(place == "Democratic Republic of the Congo", "DRC", place))

aidmapdata<- right_join(AidWorldTib, world, by = c("Country" = "place"))
?right_join

outliers<-
```

```{r}
titlePanel("Aid per country")
inputPanel(selectInput("y", label= "y-axis variable:",
              choices= c("Total Aid"= "EconomicMilitaryAssist",
                         "Economic Aid"= "EconAssist",
                         "Military Aid"="MilitaryAssist",
                         "Aid per Capita"= "AidperCapita"))
)
renderPlot({
  ggplot(AidWorldTib, mapping = aes_string(x='Country', y= input$y))+
    geom_col(aes(fill = Continent))+
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
})
titlePanel("World Map")
renderPlot({
  ggplot() + 
  geom_polygon(data = aidmapdata, aes_string(x='long', y = 'lat', group = 'group', fill = input$y)) + 
  coord_fixed(1.3) +
    labs(x= "Longitude",
         y= "Latitude")

}
)

titlePanel("Aid per Country vs. Social Indicators")

inputPanel(selectInput("YAxis", "Social Indicator:",
           choices= c("Female Life Expectancy"= "FemaleExpectancy",
                         "Male Life Expectancy"= "MaleExpectancy",
                      "Total Life Expectancy"= "TotalExpectancy"
                         )))
inputPanel(selectInput("XAxis", "Type of Aid:",
           choices= c("Total Aid"= "EconomicMilitaryAssist",
                         "Economic Aid"= "EconAssist",
                         "Military Aid"="MilitaryAssist",
                         "Aid per Capita"= "AidperCapita")))
renderPlot({
  ggplot(AidWorldTib, aes_string(x= input$XAxis, y = input$YAxis))+
    geom_point(aes(color = Continent))+
    labs(x= "Type of Aid",
         y= "Social Indicator")
})

titlePanel("Aid per Country vs. Economic Indicators")

inputPanel(selectInput("YAxis2", "Economic Indicator:",
           choices= c("GDP in US Millions"= "GDP",
                         "Gini Coefficient"= "GiniCoef",
                         "Hourly Minimum Wage"="HourlyMinWage"
                         )))
inputPanel(selectInput("XAxis2", "Type of Aid:",
           choices= c("Total Aid"= "EconomicMilitaryAssist",
                         "Economic Aid"= "EconAssist",
                         "Military Aid"="MilitaryAssist",
                         "Aid per Capita"= "AidperCapita")))
renderPlot({
  ggplot(AidWorldTib, aes_string(x= input$XAxis2, y = input$YAxis2))+
    geom_point(aes(color = Continent))+
    labs(x= "Type of Aid",
         y= "Economic Indicator")
})


```

