---
title: "MapsTest"
author: "Zach and Natalie"
date: "5/9/2019"
DisplayMode: Showcase
Type: Shiny
Output: html_document
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = FALSE}
library(tidyverse)
library(rvest)
library(httr)
library(shiny)
library(ggplot2)
library(maps)
library(readr)
library(AER)
```

```{r}
AidWorldTib <- read.csv("~/Mscs 264 S19/Inclass/AidWorldTib.csv")

world <- map_data("world")%>% 
  rename(place = region)%>%
  mutate(place = ifelse(place == "Democratic Republic of the Congo", "DRC", place))

AidWorldTib <- read_csv("~/Mscs 264 S19/Inclass/AidWorldTib.csv")

aidmapdata<- right_join(AidWorldTib, world, by = c("Country" = "place"))

```

```{r}
titlePanel("Aid per country")
inputPanel(selectInput("y", label= "y-axis variable:",
              choices= c("Total Aid"= "EconomicMilitaryAssist",
                         "Economic Aid"= "EconAssist",
                         "Military Aid"="MilitaryAssist",
                         "Aid per Capita"= "AidperCapita"))
)
renderPlot({
  ggplot(AidWorldTib, mapping = aes_string(x='Country', y= input$y))+
    geom_col()+
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
})
titlePanel("World Map")
inputPanel(
  selectInput("x", label = "Variable:",
              choices = c("Total Aid"= "EconomicMilitaryAssist",
                         "Aid per Capita"= "AidperCapita",
                         "GDP per Capita" = "GDPperCapita",
                         "Percent in Poverty" = "Percent Poverty",
                         "Life Expectancy" = "Both sexes lifeexpectency (HALE)",
                         "Gini Coefficient" = "GiniCoef",
                         "Corporate Tax Rate" = "CorporateTax")
              ))
renderPlot({
  ggplot() + 
  geom_polygon(data = aidmapdata, aes_string(x='long', y = 'lat', group = 'group', fill = input$y)) + 
  coord_fixed(1.3)
})
inputPanel(selectInput("YAxis", "Factors:",
           choices= c("Total Aid"= "EconomicMilitaryAssist",
                         "Economic Aid"= "EconAssist",
                         "Military Aid"="MilitaryAssist",
                         "Aid per Capita"= "AidperCapita")))
inputPanel(selectInput("XAxis", "Type of Aid:",
           choices= c("Total Aid"= "EconomicMilitaryAssist",
                         "Economic Aid"= "EconAssist",
                         "Military Aid"="MilitaryAssist",
                         "Aid per Capita"= "AidperCapita")))
renderPlot({
  ggplot(AidWorldTib, aes_string(x= input$XAxis, y = input$YAxis))+
    geom_point(aes(color = Continent))
})
```

